# NEXUS AuthApp - Copilot Instructions

## Architecture Overview

This is a **React Native 0.83** NEXUS authentication UI app using JavaScript (with TypeScript config). The app implements a complete dark-themed auth flow: Splash → Login → Signup → Reset Password → OTP → Home.

**Key structural decisions:**
- Entry point: [App.tsx](../App.tsx) wraps the app in `Provider (Redux)` → `GestureHandlerRootView` → `SafeAreaProvider` → `NavigationContainer` → `AuthNavigator`
- Navigation: Stack navigator in [src/navigation/AuthNavigator.js](../src/navigation/AuthNavigator.js)
- State Management: Redux Toolkit in [src/redux/](../src/redux/) - `authSlice.js` handles all auth state
- Backend: JSON Server for mock REST API at `http://10.0.2.2:3000` (Android) or `http://localhost:3000` (iOS)
- All screens use a consistent dark navy background (`#0A0E1A`) with blue accent (`#4A90D9`)
- Design tokens are centralized in `src/constants/` - never hardcode colors, spacing, or typography values

## State Management (Redux Toolkit)

### Redux Structure
```javascript
// Store setup
import { useDispatch, useSelector } from 'react-redux';
import { loginUser, signupUser, logoutUser, clearError } from '../redux/authSlice';

// Access auth state
const { user, token, isLoading, error, isAuthenticated } = useSelector((state) => state.auth);

// Dispatch actions
dispatch(loginUser({ email, password }));
dispatch(signupUser({ name, email, password }));
dispatch(logoutUser());
dispatch(clearError());
```

### Auth State Shape
```javascript
{
    user: { id, name, email } | null,
    token: string | null,
    isLoading: boolean,
    error: string | null,
    isAuthenticated: boolean
}
```

## Network Layer (Axios)

### Axios Client Setup
```javascript
// src/api/client.js - Centralized HTTP client
import apiClient from '../api/client';

// GET request with params
const response = await apiClient.get('/users', { params: { email } });

// POST request with body
const response = await apiClient.post('/users', { name, email, password });
```

**Benefits over fetch:**
- No need for `.json()` parsing - Axios does it automatically
- Better error handling - throws on 4xx/5xx responses
- Base URL configured once - no IP address repetition
- Request/Response interceptors for global handling

## Backend (JSON Server)

### Running the Server
```bash
# Install JSON Server globally
npm install -g json-server

# Start server (must run before app)
json-server --host 0.0.0.0 --watch db.json --port 3000
```

### Database Structure (db.json)
```json
{
  "users": [
    { "id": 1, "name": "John", "email": "john@test.com", "password": "123456", "createdAt": "..." }
  ]
}
```

### API Endpoints (Auto-generated by JSON Server)
- `GET /users?email=...` - Find user by email
- `GET /users?email=...&password=...` - Login (check credentials)
- `POST /users` - Create new user (signup)

## Design System (NEXUS Theme)

### Constants Layer - ALWAYS import from these files:
```javascript
import Colors from '../constants/Colors';     // Colors.background.primary, Colors.accent.primary, etc.
import Typography from '../constants/Typography'; // Typography.heading.screen, Typography.button, etc.
import Spacing from '../constants/Spacing';   // Spacing.md, Spacing.radius.input, etc.
import apiClient from '../api/client';        // Axios client (baseURL auto-configured)
```

**Key color tokens:**
- `Colors.background.primary`: `#0A0E1A` (main dark navy background)
- `Colors.background.card`: `#141828` (input field backgrounds)
- `Colors.accent.primary`: `#4A90D9` (buttons, links, focus states)
- `Colors.text.primary`: `#FFFFFF` (headings, main text)
- `Colors.text.secondary`: `#8B92A5` (subtitles, labels)
- `Colors.border.default`: `#2A3050` (unfocused input borders)
- `Colors.error.text`: `#E85D5D` (validation errors)

### Component Patterns
- Components in `src/components/` import styles from constants layer only
- `CustomInput`: Supports default/focused/filled/error states, optional eye toggle for passwords
- `CustomButton`: Full width, 52px height, disabled/loading states
- `OTPInput`: 4-box hidden TextInput pattern with visual state per box
- `ErrorMessage`: Supports both error and success types with fade animation

## Form Validation
Validation is performed client-side before API calls:
- **Email**: Basic regex validation on blur
- **Password**: Minimum 6 characters
- **Confirm Password**: Must match password field
- **OTP**: Exactly 4 numeric digits

## Navigation
Screen names: `Splash`, `Login`, `Signup`, `ResetPassword`, `OTP`, `Home`
```javascript
navigation.navigate('OTP', { email: userEmail });
navigation.replace('Home');  // Replace stack for successful auth
navigation.reset({ index: 0, routes: [{ name: 'Login' }] }); // Clear stack on logout
```

## Developer Workflows

### Running the App
```bash
# Terminal 1: Start JSON Server backend
json-server --host 0.0.0.0 --watch db.json --port 3000

# Terminal 2: Start Metro bundler & run app
npm install                    # Install dependencies
npx react-native run-android   # Android
npx react-native run-ios       # iOS (macOS only, run pod install first)
```

### Adding a New Screen
1. Create screen in `src/screens/NewScreen.js`
2. Add to stack in [AuthNavigator.js](../src/navigation/AuthNavigator.js)
3. Use `useSelector` for auth state, `useDispatch` for actions
4. Use `Colors.background.primary` as background, `KeyboardAvoidingView`, and components from `src/components/`

### Adding a New Component
1. Create in `src/components/` with props destructuring
2. Import all styles from `Colors`, `Typography`, `Spacing` constants
3. Never hardcode hex values, font sizes, or spacing numbers

### Adding New Redux Actions
1. Add async thunk in [authSlice.js](../src/redux/authSlice.js)
2. Handle pending/fulfilled/rejected in `extraReducers`
3. Export action and import in screens

## Key Dependencies
- `@reduxjs/toolkit` + `react-redux`: State management
- `axios`: HTTP client for API requests
- `json-server`: Mock REST API backend
- `react-native-vector-icons`: Ionicons for input toggles, back buttons
- `@react-navigation/stack`: Screen navigation
- `react-native-safe-area-context`: Safe area handling
- `react-native-gesture-handler`: Touch handling
